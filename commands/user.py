"""
Comandos disponibles para todos los usuarios
"""

import nextcord
from nextcord.ext import commands

from config import *
from utils import log, is_staff, log_accion

class UserCommands(commands.Cog):
    """Comandos disponibles para todos los usuarios"""
    
    def __init__(self, bot: commands.Bot):
        self.bot = bot
    
    @commands.command(name="help", description="Mostrar ayuda del bot")
    async def help_command(self, ctx):
        """Mostrar informaci√≥n de ayuda del bot"""
        try:
            # Crear embed de ayuda
            embed = nextcord.Embed(
                title=f"ü§ñ {BRAND_NAME} Bot - Ayuda",
                description="Aqu√≠ tienes informaci√≥n sobre c√≥mo usar el bot:",
                color=0x00E5A8,
                timestamp=nextcord.utils.utcnow()
            )
            
            embed.add_field(
                name="üé´ **Sistema de Tickets**",
                value="‚Ä¢ `!panel` - Mostrar panel de tickets\n‚Ä¢ `!ticket` - Crear ticket directamente\n‚Ä¢ `!limpiar_tickets` - Limpiar todos los tickets (solo staff)",
                inline=False
            )
            
            embed.add_field(
                name="üëë **Comandos de Staff**",
                value="‚Ä¢ `!admin` - Comandos de administraci√≥n\n‚Ä¢ `!mod` - Comandos de moderaci√≥n\n‚Ä¢ `!limpiar_tickets` - Limpiar sistema de tickets",
                inline=False
            )
            
            embed.add_field(
                name="üìù **Comandos Generales**",
                value="‚Ä¢ `!help` - Mostrar esta ayuda\n‚Ä¢ `!rese√±a` - Dejar una rese√±a\n‚Ä¢ `!panel` - Panel de tickets",
                inline=False
            )
            
            embed.add_field(
                name="üîß **Comandos de Moderaci√≥n**",
                value="‚Ä¢ `!limpiar` - Limpiar mensajes del canal\n‚Ä¢ `!kick` - Expulsar usuario\n‚Ä¢ `!ban` - Banear usuario",
                inline=False
            )
            
            embed.add_field(
                name="‚öôÔ∏è **Comandos de Administraci√≥n**",
                value="‚Ä¢ `!sync_commands` - Sincronizar comandos slash\n‚Ä¢ `!diagnostico` - Diagn√≥stico del bot\n‚Ä¢ `!reiniciar_bot` - Reiniciar el bot",
                inline=False
            )
            
            embed.add_field(
                name="üîß **Informaci√≥n del Bot**",
                value=f"‚Ä¢ **Servidores:** {len(self.bot.guilds)}\n‚Ä¢ **Usuarios:** {len(self.bot.users)}\n‚Ä¢ **Latencia:** {round(self.bot.latency * 1000)}ms",
                inline=False
            )
            
            embed.set_footer(text=f"{BRAND_NAME} ‚Ä¢ Soporte 24/7")
            
            await ctx.send(embed=embed)
            
        except Exception as e:
            await ctx.send(f"‚ùå Error mostrando ayuda: {str(e)}")
            log.error(f"Error en help: {e}")

    @nextcord.slash_command(name="help", description="Mostrar ayuda del bot")
    async def help(self, interaction: nextcord.Interaction):
        """Mostrar informaci√≥n de ayuda del bot"""
        try:
            # Crear embed de ayuda
            embed = nextcord.Embed(
                title=f"ü§ñ {BRAND_NAME} Bot - Ayuda",
                description="Aqu√≠ tienes informaci√≥n sobre c√≥mo usar el bot:",
                color=0x00E5A8,
                timestamp=nextcord.utils.utcnow()
            )
            
            embed.add_field(
                name="üé´ **Tickets**",
                value="‚Ä¢ Usa `/panel` para abrir un ticket\n‚Ä¢ Ve al canal #abrir-ticket y usa el panel de tickets publicado",
                inline=False
            )
            
            embed.add_field(
                name="üõçÔ∏è **Servicios**",
                value="‚Ä¢ Usa `/servicios` para ver nuestros servicios\n‚Ä¢ Usa `/pagos` para ver m√©todos de pago",
                inline=False
            )
            
            embed.add_field(
                name="‚≠ê **Rese√±as**",
                value="‚Ä¢ Usa `/rese√±a` para dejar una rese√±a\n‚Ä¢ Las rese√±as ayudan a otros usuarios",
                inline=False
            )
            
            embed.add_field(
                name="üîß **Staff**",
                value="‚Ä¢ Los comandos de staff est√°n disponibles solo para el equipo\n‚Ä¢ Contacta al staff si necesitas ayuda",
                inline=False
            )
            
            embed.set_footer(text=f"{BRAND_NAME} ‚Ä¢ Soporte 24/7")
            
            await interaction.response.send_message(embed=embed, ephemeral=True)
            
        except Exception as e:
            await interaction.response.send_message(f"‚ùå Error mostrando ayuda: {str(e)}", ephemeral=True)
            log.error(f"Error en help: {e}")

def setup(bot: commands.Bot):
    """Setup del cog"""
    bot.add_cog(UserCommands(bot))